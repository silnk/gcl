<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Company Letterhead Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c3e50, #4a6583);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 0;
        }
        
        .form-section {
            flex: 1;
            min-width: 400px;
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
        }
        
        .preview-section {
            flex: 1.5;
            min-width: 500px;
            padding: 30px;
            background: white;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 1rem;
        }
        
        .required label::after {
            content: " *";
            color: #e74c3c;
        }
        
        .optional label::after {
            content: " (optional)";
            color: #7f8c8d;
            font-size: 0.9rem;
            font-weight: normal;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .checkbox-group input {
            width: auto;
            margin-right: 12px;
            transform: scale(1.2);
        }
        
        .checkbox-group label {
            margin-bottom: 0;
            font-weight: 500;
        }
        
        .logo-upload {
            border: 2px dashed #bdc3c7;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
            background: white;
            transition: all 0.3s;
        }
        
        .logo-upload:hover {
            border-color: #3498db;
        }
        
        .logo-preview {
            max-width: 200px;
            max-height: 100px;
            margin: 15px auto;
            display: none;
        }
        
        .logo-preview img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 16px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1);
        }
        
        .btn-reset {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11);
        }
        
        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1);
        }
        
        .letterhead-preview {
            width: 100%;
            height: 800px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            background: white;
            position: relative;
            margin: 20px 0;
        }
        
        .letterhead-header {
            padding: 30px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-bottom: 1px solid #e9ecef;
            min-height: 140px;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
        }
        
        .letterhead-logo-section {
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }
        
        .letterhead-logo {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .letterhead-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .letterhead-company-info {
            flex: 1;
        }
        
        .letterhead-company-name {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .letterhead-tagline {
            font-size: 14px;
            color: #7f8c8d;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .letterhead-address {
            font-size: 12px;
            color: #34495e;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .letterhead-contact {
            font-size: 12px;
            color: #34495e;
            line-height: 1.4;
        }
        
        .letterhead-contact-item {
            margin-bottom: 3px;
        }
        
        .letterhead-extra {
            text-align: right;
            font-size: 11px;
            color: #7f8c8d;
        }
        
        .letterhead-extra-item {
            margin-bottom: 3px;
        }
        
        .letterhead-date-section {
            position: absolute;
            top: 180px;
            right: 30px;
            font-size: 12px;
            color: #34495e;
        }
        
        .letterhead-body {
            padding: 30px;
            min-height: 400px;
        }
        
        .letterhead-body h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .letterhead-body p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #34495e;
        }
        
        .letterhead-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .letterhead-footer-text {
            font-size: 11px;
            color: #7f8c8d;
        }
        
        .letterhead-footer-website {
            font-size: 11px;
            color: #3498db;
            font-weight: 600;
        }
        
        .custom-text-section {
            background: #e8f4fc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .custom-text-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .text-option-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .text-option {
            flex: 1;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }
        
        .text-option:hover {
            border-color: #3498db;
        }
        
        .text-option.active {
            border-color: #3498db;
            background: #e8f4fc;
        }
        
        .text-option h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .text-option p {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        .status {
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
            color: #2c3e50;
            padding: 15px;
            border-radius: 10px;
            background-color: #e8f4fc;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .info-section {
            background: #e8f4fc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .info-section h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .info-section p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .color-picker-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .color-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .color-option input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .template-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .template-option {
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }
        
        .template-option:hover {
            border-color: #3498db;
            transform: translateY(-2px);
        }
        
        .template-option.active {
            border-color: #3498db;
            background: #e8f4fc;
        }
        
        .template-option h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .template-option p {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        #customTextArea {
            margin-top: 15px;
        }
        
        @media (max-width: 1100px) {
            .content {
                flex-direction: column;
            }
            
            .form-section, .preview-section {
                min-width: 100%;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
        }
        
        @media (max-width: 768px) {
            .template-selector {
                grid-template-columns: 1fr;
            }
            
            .letterhead-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .letterhead-extra {
                text-align: left;
            }
            
            .text-option-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Professional Company Letterhead Generator</h1>
            <div class="subtitle">Create ISO-standard business letterheads with your company branding</div>
        </header>
        
        <div class="content">
            <div class="form-section">
                <div class="info-section">
                    <h3>üìã ISO 269 & International Standards</h3>
                    <p>This generator follows ISO 269 paper standards and international business letterhead conventions.</p>
                    <p>Paper size: A4 (210mm √ó 297mm) with proper margins and professional layout.</p>
                </div>
                
                <!-- Required Fields - Company Name and Slogan -->
                <div class="form-group required">
                    <label for="companyNameInput">Company Name *</label>
                    <input type="text" id="companyNameInput" placeholder="Enter your company name">
                </div>
                
                <div class="form-group required">
                    <label for="taglineInput">Company Tagline/Slogan *</label>
                    <input type="text" id="taglineInput" placeholder="Enter company tagline or slogan">
                </div>
                
                <!-- Optional Fields - All other information -->
                <div class="optional-section" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">Additional Information (Optional)</h4>
                    
                    <div class="form-group optional">
                        <label for="addressInput">Business Address</label>
                        <textarea id="addressInput" placeholder="Enter complete business address (optional)"></textarea>
                    </div>
                    
                    <div class="form-group optional">
                        <label for="phoneInput">Phone Number</label>
                        <input type="text" id="phoneInput" placeholder="Enter phone number (optional)">
                    </div>
                    
                    <div class="form-group optional">
                        <label for="emailInput">Email Address</label>
                        <input type="text" id="emailInput" placeholder="Enter email address (optional)">
                    </div>
                    
                    <div class="form-group optional">
                        <label for="websiteInput">Website URL</label>
                        <input type="text" id="websiteInput" placeholder="Enter website URL (optional)">
                    </div>
                    
                    <div class="form-group optional">
                        <label for="registrationInput">Registration/License Number</label>
                        <input type="text" id="registrationInput" placeholder="Enter registration or license number (optional)">
                    </div>
                    
                    <div class="form-group optional">
                        <label for="taxInput">Tax/VAT Number</label>
                        <input type="text" id="taxInput" placeholder="Enter tax or VAT number (optional)">
                    </div>
                </div>
                
                <!-- Custom Text Options -->
                <div class="custom-text-section">
                    <h3>üìù Letter Content Options</h3>
                    <div class="text-option-group">
                        <div class="text-option active" data-text="default">
                            <h4>Default Text</h4>
                            <p>Use standard sample text</p>
                        </div>
                        <div class="text-option" data-text="custom">
                            <h4>Custom Text</h4>
                            <p>Add your own letter content</p>
                        </div>
                        <div class="text-option" data-text="blank">
                            <h4>Blank Letterhead</h4>
                            <p>No text - just letterhead design</p>
                        </div>
                    </div>
                    
                    <div id="customTextArea" style="display: none;">
                        <label for="customLetterText">Your Letter Content:</label>
                        <textarea id="customLetterText" placeholder="Enter your letter content here..." style="min-height: 200px;"></textarea>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Template Style</label>
                    <div class="template-selector">
                        <div class="template-option active" data-template="modern">
                            <h4>Modern</h4>
                            <p>Clean, minimalist design with logo left, info right</p>
                        </div>
                        <div class="template-option" data-template="classic">
                            <h4>Classic</h4>
                            <p>Traditional centered layout with elegant typography</p>
                        </div>
                        <div class="template-option" data-template="corporate">
                            <h4>Corporate</h4>
                            <p>Professional horizontal layout with color accents</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Company Logo</label>
                    <div class="logo-upload">
                        <input type="file" id="logoInput" accept="image/*" style="display: none;">
                        <button type="button" onclick="document.getElementById('logoInput').click()" class="btn btn-primary">
                            üìÅ Upload Company Logo
                        </button>
                        <div class="logo-preview" id="logoPreview">
                            <img id="logoPreviewImg" src="" alt="Logo Preview">
                        </div>
                        <p style="font-size: 14px; color: #7f8c8d; margin-top: 10px;">Recommended: PNG format, max 200√ó100px, transparent background</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Color Customization</label>
                    <div class="color-picker-group">
                        <div class="color-option">
                            <label for="primaryColor">Primary Color:</label>
                            <input type="color" id="primaryColor" value="#2c3e50">
                        </div>
                        <div class="color-option">
                            <label for="secondaryColor">Secondary Color:</label>
                            <input type="color" id="secondaryColor" value="#3498db">
                        </div>
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="showWatermark" checked>
                    <label for="showWatermark">Show subtle logo watermark background</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="showPageNumbers" checked>
                    <label for="showPageNumbers">Show page numbers in footer</label>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="updatePreview()">
                        üëÅÔ∏è Update Preview
                    </button>
                    <button class="btn btn-primary" onclick="generatePDF()">
                        üìÑ Generate Letterhead PDF
                    </button>
                    <button class="btn btn-reset" onclick="resetApp()">
                        üîÑ Reset All
                    </button>
                </div>
            </div>
            
            <div class="preview-section">
                <h3 style="margin-bottom: 20px; color: #2c3e50;">Letterhead Preview (A4 Standard)</h3>
                
                <div class="letterhead-preview" id="letterheadPreview">
                    <!-- Preview will be generated here -->
                </div>
                
                <div class="status" id="status">
                    Fill in your company information and click "Update Preview" to see the letterhead.
                </div>
                
                <div class="info-section">
                    <h3>üí° ISO Standards Compliance</h3>
                    <p>‚Ä¢ A4 paper size: 210mm √ó 297mm</p>
                    <p>‚Ä¢ Proper margins: 25mm top/bottom, 20mm left/right</p>
                    <p>‚Ä¢ Professional typography hierarchy</p>
                    <p>‚Ä¢ Consistent branding elements</p>
                    <p>‚Ä¢ Print-ready CMYK-friendly colors</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;

        // DOM elements
        const letterheadPreview = document.getElementById('letterheadPreview');
        const status = document.getElementById('status');
        const logoInput = document.getElementById('logoInput');
        const logoPreview = document.getElementById('logoPreview');
        const logoPreviewImg = document.getElementById('logoPreviewImg');
        const templateOptions = document.querySelectorAll('.template-option');
        const textOptions = document.querySelectorAll('.text-option');
        const customTextArea = document.getElementById('customTextArea');
        
        // Store the company logo
        let companyLogo = '';
        let currentTemplate = 'modern';
        let currentTextOption = 'default';

        // Handle logo upload
        logoInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
                const file = this.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    companyLogo = e.target.result;
                    logoPreviewImg.src = companyLogo;
                    logoPreview.style.display = 'block';
                    status.textContent = 'Logo uploaded successfully! Click "Update Preview" to see changes.';
                };
                
                reader.readAsDataURL(file);
            }
        });

        // Template selection
        templateOptions.forEach(option => {
            option.addEventListener('click', function() {
                templateOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                currentTemplate = this.dataset.template;
                updatePreview();
            });
        });

        // Text option selection
        textOptions.forEach(option => {
            option.addEventListener('click', function() {
                textOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                currentTextOption = this.dataset.text;
                
                // Show/hide custom text area
                if (currentTextOption === 'custom') {
                    customTextArea.style.display = 'block';
                } else {
                    customTextArea.style.display = 'none';
                }
                
                updatePreview();
            });
        });

        // Get letter content based on selected option
        function getLetterContent() {
            const companyName = document.getElementById('companyNameInput').value || 'Your Company Name';
            
            switch(currentTextOption) {
                case 'custom':
                    const customText = document.getElementById('customLetterText').value;
                    return customText || 'Your custom letter content will appear here...';
                
                case 'blank':
                    return '';
                
                case 'default':
                default:
                    return `Dear [Recipient Name],

This letterhead follows ISO 269 A4 paper standards with proper margins and professional layout.

The design incorporates your company branding with consistent typography and color scheme.

All elements are positioned according to international business letterhead conventions.

Best regards,
${companyName}

P.S. This PDF is print-ready and optimized for professional business communications.`;
            }
        }

        // Update letterhead preview
        function updatePreview() {
            const companyName = document.getElementById('companyNameInput').value || 'Your Company Name';
            const tagline = document.getElementById('taglineInput').value || 'Your Company Tagline';
            const address = document.getElementById('addressInput').value || '';
            const phone = document.getElementById('phoneInput').value || '';
            const email = document.getElementById('emailInput').value || '';
            const website = document.getElementById('websiteInput').value || '';
            const registration = document.getElementById('registrationInput').value;
            const tax = document.getElementById('taxInput').value;
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const showWatermark = document.getElementById('showWatermark').checked;
            const showPageNumbers = document.getElementById('showPageNumbers').checked;

            const letterContent = getLetterContent();
            const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            let previewHTML = '';

            switch(currentTemplate) {
                case 'modern':
                    previewHTML = `
                        <div class="letterhead-header" style="background: linear-gradient(135deg, #ffffff 0%, ${primaryColor}08 100%);">
                            <div class="letterhead-logo-section">
                                <div class="letterhead-logo">
                                    ${companyLogo ? `<img src="${companyLogo}" alt="Company Logo">` : '<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #ccc; font-size: 12px;">LOGO</div>'}
                                </div>
                                <div class="letterhead-company-info">
                                    <div class="letterhead-company-name" style="color: ${primaryColor};">${companyName}</div>
                                    <div class="letterhead-tagline">${tagline}</div>
                                    ${address ? `<div class="letterhead-address">${address.replace(/\n/g, '<br>')}</div>` : ''}
                                    ${phone || email ? `<div class="letterhead-contact">
                                        ${phone ? `<div class="letterhead-contact-item">${phone}</div>` : ''}
                                        ${email ? `<div class="letterhead-contact-item">${email}</div>` : ''}
                                        ${website ? `<div class="letterhead-contact-item">${website}</div>` : ''}
                                    </div>` : ''}
                                </div>
                            </div>
                            <div class="letterhead-extra">
                                ${registration ? `<div class="letterhead-extra-item">Reg: ${registration}</div>` : ''}
                                ${tax ? `<div class="letterhead-extra-item">VAT: ${tax}</div>` : ''}
                                ${website ? `<div class="letterhead-extra-item" style="color: ${secondaryColor};">${website}</div>` : ''}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'classic':
                    previewHTML = `
                        <div class="letterhead-header" style="text-align: center; background: linear-gradient(135deg, #ffffff 0%, ${primaryColor}05 100%);">
                            <div class="letterhead-company-info">
                                ${companyLogo ? `<div class="letterhead-logo" style="margin: 0 auto 15px;"><img src="${companyLogo}" alt="Company Logo"></div>` : ''}
                                <div class="letterhead-company-name" style="color: ${primaryColor}; font-size: 28px;">${companyName}</div>
                                <div class="letterhead-tagline">${tagline}</div>
                                ${address || phone || email ? `<div style="margin-top: 20px; font-size: 12px; color: #34495e;">
                                    ${address ? `<div>${address.replace(/\n/g, ' | ')}</div>` : ''}
                                    <div style="margin-top: 8px;">
                                        ${phone ? `${phone}` : ''}${phone && email ? ' | ' : ''}${email ? `${email}` : ''}
                                        ${website ? ` | ${website}` : ''}
                                    </div>
                                    ${registration || tax ? `<div style="margin-top: 8px; color: ${secondaryColor};">
                                        ${registration ? `Reg: ${registration}` : ''}
                                        ${registration && tax ? ' | ' : ''}
                                        ${tax ? `VAT: ${tax}` : ''}
                                    </div>` : ''}
                                </div>` : ''}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'corporate':
                    previewHTML = `
                        <div class="letterhead-header" style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white;">
                            <div class="letterhead-logo-section">
                                <div class="letterhead-logo" style="border-color: rgba(255,255,255,0.3);">
                                    ${companyLogo ? `<img src="${companyLogo}" alt="Company Logo">` : '<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: rgba(255,255,255,0.7); font-size: 12px;">LOGO</div>'}
                                </div>
                                <div class="letterhead-company-info">
                                    <div class="letterhead-company-name" style="color: white; font-size: 26px;">${companyName}</div>
                                    <div class="letterhead-tagline" style="color: rgba(255,255,255,0.9);">${tagline}</div>
                                </div>
                            </div>
                        </div>
                        ${address || phone || email || website ? `<div style="padding: 15px 30px; background: ${primaryColor}08; border-bottom: 1px solid ${primaryColor}20;">
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #34495e;">
                                <div>
                                    ${address ? `<div>${address.replace(/\n/g, ' | ')}</div>` : ''}
                                    ${phone || email ? `<div style="margin-top: 5px;">${phone ? `${phone}` : ''}${phone && email ? ' | ' : ''}${email ? `${email}` : ''}</div>` : ''}
                                </div>
                                <div style="text-align: right;">
                                    ${website ? `<div>${website}</div>` : ''}
                                    ${registration ? `<div style="margin-top: 5px;">Reg: ${registration}</div>` : ''}
                                    ${tax ? `<div style="margin-top: 5px;">VAT: ${tax}</div>` : ''}
                                </div>
                            </div>
                        </div>` : ''}
                    `;
                    break;
            }

            // Add date section
            previewHTML += `
                <div class="letterhead-date-section">
                    <div style="font-weight: 600; color: ${primaryColor}; margin-bottom: 5px;">Date</div>
                    <div>${today}</div>
                </div>
            `;

            // Add body section with letter content
            if (letterContent) {
                previewHTML += `
                    <div class="letterhead-body">
                        <div style="white-space: pre-line; font-family: inherit; font-size: 14px; line-height: 1.6; color: #34495e;">
                            ${letterContent}
                        </div>
                    </div>
                `;
            } else {
                // Empty letterhead for custom writing
                previewHTML += `
                    <div class="letterhead-body" style="min-height: 500px;">
                        <div style="border: 2px dashed #e9ecef; height: 100%; display: flex; align-items: center; justify-content: center; color: #adb5bd; font-size: 16px; text-align: center;">
                            <div>
                                <div style="font-size: 24px; margin-bottom: 10px;">üìù</div>
                                <div>Ready for your custom letter content</div>
                                <div style="font-size: 14px; margin-top: 10px;">Print this blank letterhead and write your letter by hand,<br>or generate with your custom text</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Add footer
            previewHTML += `
                <div class="letterhead-footer" style="background: linear-gradient(135deg, ${primaryColor}08 0%, #f8f9fa 100%);">
                    <div class="letterhead-footer-text">
                        ${showPageNumbers ? 'Page 1 of 1' : ''}
                    </div>
                    <div class="letterhead-footer-website" style="color: ${secondaryColor};">
                        ${website || 'www.yourcompany.com'}
                    </div>
                </div>
            `;

            letterheadPreview.innerHTML = previewHTML;
            status.textContent = 'Letterhead preview updated! Click "Generate Letterhead PDF" to create your printable version.';
        }

        // Generate PDF
        function generatePDF() {
            const companyName = document.getElementById('companyNameInput').value;
            const tagline = document.getElementById('taglineInput').value;
            const address = document.getElementById('addressInput').value;
            const phone = document.getElementById('phoneInput').value;
            const email = document.getElementById('emailInput').value;
            const website = document.getElementById('websiteInput').value;
            const registration = document.getElementById('registrationInput').value;
            const tax = document.getElementById('taxInput').value;
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const showWatermark = document.getElementById('showWatermark').checked;
            const showPageNumbers = document.getElementById('showPageNumbers').checked;
            const letterContent = getLetterContent();

            // Check only required fields
            if (!companyName || !tagline) {
                status.textContent = 'Please fill in Company Name and Tagline (required fields).';
                return;
            }

            status.textContent = 'Generating professional letterhead PDF...';

            // Create PDF with A4 dimensions
            const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });

            // A4 dimensions: 210mm √ó 297mm
            const pageWidth = 210;
            const pageHeight = 297;
            const marginTop = 25;
            const marginBottom = 25;
            const marginLeft = 20;
            const marginRight = 20;
            const contentWidth = pageWidth - marginLeft - marginRight;

            // Colors (CMYK-friendly)
            const rgbToCmyk = (hex) => {
                const r = parseInt(hex.slice(1, 3), 16) / 255;
                const g = parseInt(hex.slice(3, 5), 16) / 255;
                const b = parseInt(hex.slice(5, 7), 16) / 255;
                const k = 1 - Math.max(r, g, b);
                const c = (1 - r - k) / (1 - k) || 0;
                const m = (1 - g - k) / (1 - k) || 0;
                const y = (1 - b - k) / (1 - k) || 0;
                return { c, m, y, k };
            };

            const primaryCMYK = rgbToCmyk(primaryColor);
            const secondaryCMYK = rgbToCmyk(secondaryColor);

            // Add watermark if enabled
            if (showWatermark) {
                // Transparent background
                pdf.setFillColor(250, 250, 250);
                pdf.rect(0, 0, pageWidth, pageHeight, 'F');
                
                // Logo watermark (if available)
                if (companyLogo) {
                    try {
                        // Large centered logo with transparency effect
                        pdf.setGState(new pdf.GState({ opacity: 0.08 }));
                        pdf.addImage(companyLogo, 'PNG', 
                            pageWidth/2 - 60, pageHeight/2 - 40, 
                            120, 80);
                        pdf.setGState(new pdf.GState({ opacity: 1 }));
                    } catch (error) {
                        console.error('Error adding logo watermark:', error);
                    }
                } else {
                    // Company name text watermark
                    pdf.setFontSize(60);
                    pdf.setTextColor(248, 248, 248);
                    pdf.setFont(undefined, 'bold');
                    const watermarkText = companyName.substring(0, 20).toUpperCase();
                    const watermarkWidth = pdf.getTextWidth(watermarkText);
                    pdf.text(watermarkText, (pageWidth - watermarkWidth) / 2, pageHeight / 2, { 
                        angle: 45,
                        align: 'center'
                    });
                    pdf.setFont(undefined, 'normal');
                }
            }

            // Generate letterhead based on template
            switch(currentTemplate) {
                case 'modern':
                    // Modern template
                    pdf.setFillColor(primaryCMYK.c * 255, primaryCMYK.m * 255, primaryCMYK.y * 255, primaryCMYK.k * 255);
                    pdf.rect(marginLeft, marginTop - 10, contentWidth, 0.5, 'F');
                    
                    // Logo
                    if (companyLogo) {
                        try {
                            pdf.addImage(companyLogo, 'PNG', marginLeft, marginTop - 5, 25, 25);
                        } catch (error) {
                            console.error('Error adding logo to PDF:', error);
                        }
                    }
                    
                    // Company info
                    pdf.setFontSize(16);
                    pdf.setTextColor(primaryCMYK.c * 255, primaryCMYK.m * 255, primaryCMYK.y * 255, primaryCMYK.k * 255);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(companyName, marginLeft + (companyLogo ? 30 : 0), marginTop + 5);
                    pdf.setFont(undefined, 'normal');
                    
                    pdf.setFontSize(11);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text(tagline, marginLeft + (companyLogo ? 30 : 0), marginTop + 10);
                    
                    // Optional fields
                    if (address) {
                        pdf.setFontSize(9);
                        pdf.setTextColor(50, 50, 50);
                        let contactY = marginTop + 18;
                        const addressLines = pdf.splitTextToSize(address, contentWidth - 100);
                        addressLines.forEach(line => {
                            pdf.text(line, marginLeft + (companyLogo ? 30 : 0), contactY);
                            contactY += 4;
                        });
                    }
                    
                    if (phone) {
                        pdf.setFontSize(9);
                        pdf.setTextColor(50, 50, 50);
                        let phoneY = address ? marginTop + 18 + (address.split('\n').length * 4) + 2 : marginTop + 18;
                        pdf.text(phone, marginLeft + (companyLogo ? 30 : 0), phoneY);
                    }
                    
                    if (email) {
                        pdf.setFontSize(9);
                        pdf.setTextColor(50, 50, 50);
                        let emailY = marginTop + (address ? 18 + (address.split('\n').length * 4) + (phone ? 6 : 2) : 18);
                        if (phone) emailY += 4;
                        pdf.text(email, marginLeft + (companyLogo ? 30 : 0), emailY);
                    }
                    
                    if (website) {
                        pdf.setFontSize(9);
                        pdf.setTextColor(50, 50, 50);
                        let websiteY = marginTop + 18 + (address ? (address.split('\n').length * 4) : 0) + (phone ? 4 : 0) + (email ? 4 : 0);
                        pdf.text(website, marginLeft + (companyLogo ? 30 : 0), websiteY);
                    }
                    
                    // Right side info (optional)
                    const rightX = marginLeft + contentWidth - 50;
                    pdf.setFontSize(8);
                    if (registration) pdf.text(`Reg: ${registration}`, rightX, marginTop + 5);
                    if (tax) pdf.text(`VAT: ${tax}`, rightX, marginTop + 10);
                    if (website) {
                        pdf.setTextColor(secondaryCMYK.c * 255, secondaryCMYK.m * 255, secondaryCMYK.y * 255, secondaryCMYK.k * 255);
                        pdf.text(website, rightX, marginTop + 15);
                    }
                    break;
                    
                case 'classic':
                    // Classic centered template
                    pdf.setFillColor(primaryCMYK.c * 255, primaryCMYK.m * 255, primaryCMYK.y * 255, primaryCMYK.k * 255);
                    pdf.rect(marginLeft, marginTop - 10, contentWidth, 0.3, 'F');
                    
                    // Centered layout
                    const centerX = pageWidth / 2;
                    
                    if (companyLogo) {
                        try {
                            pdf.addImage(companyLogo, 'PNG', centerX - 15, marginTop - 5, 30, 30);
                        } catch (error) {
                            console.error('Error adding logo to PDF:', error);
                        }
                    }
                    
                    pdf.setFontSize(18);
                    pdf.setTextColor(primaryCMYK.c * 255, primaryCMYK.m * 255, primaryCMYK.y * 255, primaryCMYK.k * 255);
                    pdf.setFont(undefined, 'bold');
                    const companyWidth = pdf.getTextWidth(companyName);
                    pdf.text(companyName, centerX - companyWidth / 2, marginTop + 25);
                    pdf.setFont(undefined, 'normal');
                    
                    pdf.setFontSize(11);
                    pdf.setTextColor(100, 100, 100);
                    const taglineWidth = pdf.getTextWidth(tagline);
                    pdf.text(tagline, centerX - taglineWidth / 2, marginTop + 30);
                    
                    // Optional contact info
                    if (address || phone || email) {
                        pdf.setFontSize(9);
                        pdf.setTextColor(50, 50, 50);
                        let infoY = marginTop + 40;
                        
                        if (address) {
                            const addressWidth = pdf.getTextWidth(address.replace(/\n/g, ' | '));
                            pdf.text(address.replace(/\n/g, ' | '), centerX - addressWidth / 2, infoY);
                            infoY += 5;
                        }
                        
                        const contactText = `${phone ? phone : ''}${phone && email ? ' | ' : ''}${email ? email : ''}${(phone || email) && website ? ` | ${website}` : ''}`;
                        if (contactText.trim()) {
                            const contactWidth = pdf.getTextWidth(contactText);
                            pdf.text(contactText, centerX - contactWidth / 2, infoY);
                        }
                        
                        if (registration || tax) {
                            const regText = `${registration ? `Reg: ${registration}` : ''}${registration && tax ? ' | ' : ''}${tax ? `VAT: ${tax}` : ''}`;
                            if (regText.trim()) {
                                const regWidth = pdf.getTextWidth(regText);
                                pdf.setTextColor(secondaryCMYK.c * 255, secondaryCMYK.m * 255, secondaryCMYK.y * 255, secondaryCMYK.k * 255);
                                pdf.text(regText, centerX - regWidth / 2, infoY + 5);
                            }
                        }
                    }
                    break;
                    
                case 'corporate':
                    // Corporate colored header
                    pdf.setFillColor(primaryCMYK.c * 255, primaryCMYK.m * 255, primaryCMYK.y * 255, primaryCMYK.k * 255);
                    pdf.rect(marginLeft, marginTop - 15, contentWidth, 25, 'F');
                    
                    // White text on colored background
                    pdf.setTextColor(255, 255, 255);
                    pdf.setFontSize(16);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(companyName, marginLeft, marginTop - 2);
                    pdf.setFont(undefined, 'normal');
                    
                    pdf.setFontSize(11);
                    pdf.text(tagline, marginLeft, marginTop + 3);
                    
                    // Logo in header
                    if (companyLogo) {
                        try {
                            pdf.addImage(companyLogo, 'PNG', marginLeft + contentWidth - 25, marginTop - 12, 20, 20);
                        } catch (error) {
                            console.error('Error adding logo to PDF:', error);
                        }
                    }
                    
                    // Secondary info bar (with optional info)
                    pdf.setFillColor(secondaryCMYK.c * 50, secondaryCMYK.m * 50, secondaryCMYK.y * 50, secondaryCMYK.k * 50);
                    pdf.rect(marginLeft, marginTop + 12, contentWidth, 12, 'F');
                    
                    pdf.setFontSize(8);
                    pdf.setTextColor(50, 50, 50);
                    
                    let leftInfoY = marginTop + 17;
                    if (address) {
                        pdf.text(address.replace(/\n/g, ' | '), marginLeft, leftInfoY);
                        leftInfoY += 4;
                    }
                    if (phone || email) {
                        const contactText = `${phone ? phone : ''}${phone && email ? ' | ' : ''}${email ? email : ''}`;
                        if (contactText.trim()) {
                            pdf.text(contactText, marginLeft, leftInfoY);
                        }
                    }
                    
                    const rightInfoX = marginLeft + contentWidth - 60;
                    if (website) pdf.text(website, rightInfoX, marginTop + 17);
                    if (registration) pdf.text(`Reg: ${registration}`, rightInfoX, marginTop + 21);
                    break;
            }

            // Footer
            pdf.setFillColor(240, 240, 240);
            pdf.rect(marginLeft, pageHeight - marginBottom - 8, contentWidth, 8, 'F');
            
            pdf.setFontSize(8);
            pdf.setTextColor(100, 100, 100);
            if (showPageNumbers) {
                pdf.text('Page 1 of 1', marginLeft, pageHeight - marginBottom - 3);
            }
            if (website) {
                pdf.setTextColor(secondaryCMYK.c * 255, secondaryCMYK.m * 255, secondaryCMYK.y * 255, secondaryCMYK.k * 255);
                pdf.text(website, marginLeft + contentWidth - pdf.getTextWidth(website), pageHeight - marginBottom - 3);
            }

            // Add letter content
            if (letterContent) {
                pdf.setFontSize(11);
                pdf.setTextColor(0, 0, 0);
                const lines = letterContent.split('\n');
                let contentY = marginTop + 60;
                lines.forEach((line, index) => {
                    if (line.trim()) {
                        pdf.text(line, marginLeft, contentY);
                    }
                    contentY += index === 0 ? 8 : 6;
                });
            }

            // Save the PDF
            pdf.save(`${companyName.replace(/\s+/g, '-').toLowerCase()}-letterhead.pdf`);
            status.textContent = 'Professional letterhead PDF generated successfully! Check your downloads folder.';
        }

        function resetApp() {
            // Clear form inputs
            document.getElementById('companyNameInput').value = '';
            document.getElementById('taglineInput').value = '';
            document.getElementById('addressInput').value = '';
            document.getElementById('phoneInput').value = '';
            document.getElementById('emailInput').value = '';
            document.getElementById('websiteInput').value = '';
            document.getElementById('registrationInput').value = '';
            document.getElementById('taxInput').value = '';
            document.getElementById('primaryColor').value = '#2c3e50';
            document.getElementById('secondaryColor').value = '#3498db';
            document.getElementById('logoInput').value = '';
            document.getElementById('showWatermark').checked = true;
            document.getElementById('showPageNumbers').checked = true;
            document.getElementById('customLetterText').value = '';
            
            // Clear logo preview
            logoPreview.style.display = 'none';
            companyLogo = '';
            
            // Reset template
            templateOptions.forEach(opt => opt.classList.remove('active'));
            templateOptions[0].classList.add('active');
            currentTemplate = 'modern';
            
            // Reset text option
            textOptions.forEach(opt => opt.classList.remove('active'));
            textOptions[0].classList.add('active');
            currentTextOption = 'default';
            customTextArea.style.display = 'none';
            
            // Clear preview
            letterheadPreview.innerHTML = '';
            
            status.textContent = 'All data cleared. Fill in your company information to get started!';
        }

        // Initialize with sample preview
        window.addEventListener('load', function() {
            updatePreview();
        });
    </script>
</body>
</html>
